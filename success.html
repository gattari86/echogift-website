<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmed - EchoGift</title>
    <meta name="description" content="Your personalized song order has been confirmed. We'll start creating your custom song gift right away!">
    <meta name="robots" content="noindex, nofollow">
    <link rel="canonical" href="https://echogifts.shop/success.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prata:wght@400&family=Lato:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Navigation Header -->
    <header class="main-header">
        <div class="container">
            <nav class="main-nav">
                <a href="index.html" class="logo">EchoGift</a>
                <div class="nav-menu">
                    <a href="about.html" class="nav-link">About</a>
                    <a href="gallery.html" class="nav-link">üéµ Gallery</a>
                    <a href="single-song.html" class="nav-link">Single Song ($79)</a>
                    <a href="album-gift.html" class="nav-link">Album Gift ($299)</a>
                    <a href="blog.html" class="nav-link">üìù Blog</a>
                    <a href="index.html#order" class="nav-cta">Order Now</a>
                </div>
                <div class="mobile-menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <!-- Success Hero Section -->
    <section style="background: var(--gradient-warm); padding: 120px 0; position: relative; overflow: hidden;">
        <!-- Premium Background Layer -->
        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('assets/premium/hero_emotional/joy_through_tears_premium.jpg') center center / cover no-repeat; opacity: 0.08;"></div>
        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: var(--gradient-subtle);"></div>
        <div class="container" style="position: relative; z-index: 3;">
            <div style="max-width: 700px; margin: 0 auto; text-align: center;">
                <div style="width: 80px; height: 80px; background: var(--gradient-luxury); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 32px; box-shadow: var(--shadow-lg);">
                    <span style="font-size: 40px; color: white;">‚úì</span>
                </div>
                <h1 style="font-family: 'Prata', serif; font-size: clamp(2.5rem, 5vw, 3.5rem); color: var(--deep-indigo); margin-bottom: 24px; line-height: 1.2;">Order Confirmed!</h1>
                <p style="font-size: 20px; color: var(--text-secondary); line-height: 1.6;">Thank you for your order. We're excited to create your personalized song gift!</p>
            </div>
        </div>
    </section>

    <!-- Order Details Section -->
    <section style="padding: 100px 0; background: white; position: relative;">
        <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: url('assets/premium/premium_textures/elegant_beige_marble_luxury.jpg') center center / cover no-repeat; opacity: 0.02;"></div>
        <div class="container" style="position: relative; z-index: 2;">
            <div style="max-width: 800px; margin: 0 auto;">
                <div style="background: rgba(255, 255, 255, 0.9); border-radius: 16px; padding: 48px; box-shadow: var(--shadow-lg); backdrop-filter: blur(20px); border: 1px solid rgba(232, 201, 207, 0.2);">
                
                    <h2 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: clamp(1.8rem, 3vw, 2.5rem); margin-bottom: 32px; text-align: center;">Order Details</h2>
                    
                    <div style="display: grid; gap: 24px; margin-bottom: 40px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(232, 201, 207, 0.3);">
                            <span style="font-family: 'Lato', sans-serif; font-weight: 500; color: var(--text-secondary);">Order Number:</span>
                            <span id="order-id" style="font-family: 'Lato', sans-serif; font-weight: 600; color: var(--deep-indigo);">EG-1234567890</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(232, 201, 207, 0.3);">
                            <span style="font-family: 'Lato', sans-serif; font-weight: 500; color: var(--text-secondary);">Product:</span>
                            <span id="product-name" style="font-family: 'Lato', sans-serif; font-weight: 600; color: var(--deep-indigo);">Personalized Song</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(232, 201, 207, 0.3);">
                            <span style="font-family: 'Lato', sans-serif; font-weight: 500; color: var(--text-secondary);">Total Paid:</span>
                            <span id="amount-paid" style="font-family: 'Lato', sans-serif; font-weight: 600; color: var(--terracotta); font-size: 18px;">$81.30</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid rgba(232, 201, 207, 0.3);">
                            <span style="font-family: 'Lato', sans-serif; font-weight: 500; color: var(--text-secondary);">Email:</span>
                            <span id="customer-email" style="font-family: 'Lato', sans-serif; font-weight: 600; color: var(--deep-indigo);">customer@example.com</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
                            <span style="font-family: 'Lato', sans-serif; font-weight: 500; color: var(--text-secondary);">Estimated Delivery:</span>
                            <span id="delivery-date" style="font-family: 'Lato', sans-serif; font-weight: 600; color: var(--deep-indigo);">Monday, January 15, 2024</span>
                        </div>
                    </div>

                    <h3 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: clamp(1.5rem, 2.5vw, 2rem); margin-bottom: 32px; text-align: center;">What Happens Next?</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 32px;">
                        <div style="text-align: center; padding: 24px;">
                            <div style="width: 60px; height: 60px; background: var(--gradient-luxury); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; color: white; font-family: 'Prata', serif; font-size: 24px; font-weight: 600;">1</div>
                            <h4 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: 18px; margin-bottom: 12px;">We Start Creating</h4>
                            <p style="font-family: 'Lato', sans-serif; color: var(--text-secondary); line-height: 1.6; font-size: 16px;">Our AI begins crafting your personalized song using the story and details you provided.</p>
                        </div>
                        <div style="text-align: center; padding: 24px;">
                            <div style="width: 60px; height: 60px; background: var(--gradient-luxury); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; color: white; font-family: 'Prata', serif; font-size: 24px; font-weight: 600;">2</div>
                            <h4 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: 18px; margin-bottom: 12px;">Quality Review</h4>
                            <p style="font-family: 'Lato', sans-serif; color: var(--text-secondary); line-height: 1.6; font-size: 16px;">Our team reviews the song to ensure it meets our high standards and captures your story perfectly.</p>
                            </div>
                        </div>
                        <div style="text-align: center; padding: 24px;">
                            <div style="width: 60px; height: 60px; background: var(--gradient-luxury); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; color: white; font-family: 'Prata', serif; font-size: 24px; font-weight: 600;">3</div>
                            <h4 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: 18px; margin-bottom: 12px;">Delivery</h4>
                            <p style="font-family: 'Lato', sans-serif; color: var(--text-secondary); line-height: 1.6; font-size: 16px;">You'll receive your custom song via email within 5 business days, ready to share and enjoy!</p>
                        </div>
                    </div>
                    
                    <div style="background: rgba(232, 201, 207, 0.1); border-radius: 12px; padding: 32px; margin-top: 48px; text-align: center;">
                        <h3 style="font-family: 'Prata', serif; color: var(--deep-indigo); font-size: 20px; margin-bottom: 16px;">Questions or Concerns?</h3>
                        <p style="font-family: 'Lato', sans-serif; color: var(--text-secondary); line-height: 1.6; font-size: 16px;">We're here to help! Contact us at <a href="mailto:hello@echogifts.shop" style="color: var(--terracotta); text-decoration: none; font-weight: 600;">hello@echogifts.shop</a> or reference your order number <span id="order-reference" style="font-weight: 600; color: var(--deep-indigo);">EG-1234567890</span> in any correspondence.</p>
                    </div>

                    <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap; margin-top: 40px;">
                        <a href="index.html" class="cta-button" style="min-width: 200px;">Create Another Song</a>
                        <a href="mailto:?subject=I just ordered a personalized song!&body=I just ordered a custom song from EchoGift! Check them out at echogifts.shop" class="cta-button secondary" style="min-width: 200px;">Share with Friends</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>EchoGift</h3>
                    <p>Your story, your song.</p>
                </div>
                <div class="footer-links">
                    <a href="blog.html">Blog</a>
                    <a href="terms-of-service.html">Terms of Service</a>
                    <a href="privacy-policy.html">Privacy Policy</a>
                    <a href="mailto:hello@echogifts.shop">Contact</a>
                </div>
                <div class="footer-social">
                    <a href="#" aria-label="Facebook">üìò</a>
                    <a href="#" aria-label="Instagram">üì∑</a>
                    <a href="#" aria-label="Twitter">üê¶</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 EchoGift. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Stripe configuration
        const stripe = Stripe('pk_live_51RTWhNEinaZMSMtjUEnWpzUPDC8KZBlFOy9O4Is2iG6KDg0CrCLszCw8QksowdNQcUyFdp8BIuWmSPMYueau2t5200ayCjCLBw');
        
        // Load confirmation data and populate page
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const sessionId = urlParams.get('session_id');
            const isElysonFree = urlParams.get('elyson') === 'true';
            
            if (isElysonFree) {
                // Coming from free Elyson order
                handleElysonSuccess();
            } else if (sessionId) {
                // Coming from Stripe Checkout
                retrieveStripeSession(sessionId);
            } else {
                // Try to load from sessionStorage (fallback)
                const confirmationData = JSON.parse(sessionStorage.getItem('confirmationData') || '{}');
                
                if (!confirmationData.orderId) {
                    // No confirmation data, redirect to home
                    window.location.href = 'index.html';
                    return;
                }

                populateOrderDetails(confirmationData);
            }
        });
        
        function handleElysonSuccess() {
            // Create confirmation data for Elyson free order
            const confirmationData = {
                orderId: 'ELYSON-' + Date.now().toString().slice(-6),
                amount: 0.00,
                productType: 'elyson',
                productName: 'Elyson Special - FREE',
                email: 'Free Order',
                paymentStatus: 'No payment required',
                isElysonFree: true
            };
            
            populateOrderDetails(confirmationData);
        }

        async function retrieveStripeSession(sessionId) {
            try {
                // Note: In production, you'd need a server endpoint to retrieve session details
                // For now, we'll create mock data based on sessionStorage order data
                const orderData = JSON.parse(sessionStorage.getItem('orderData') || '{}');
                
                const confirmationData = {
                    orderId: 'EG-' + sessionId.substring(-8),
                    amount: orderData.productType === 'single' ? 79.00 : 299.00,
                    product: orderData.productType === 'single' ? 'Personalized Song' : 'Custom Song Album',
                    email: orderData.email || 'customer@example.com',
                    estimatedDelivery: getEstimatedDelivery(),
                    sessionId: sessionId
                };
                
                populateOrderDetails(confirmationData);
                
                // Clear order data after successful payment
                sessionStorage.removeItem('orderData');
                
                // Show success message
                showSuccessMessage('Payment successful! Your order has been confirmed.');
                
            } catch (error) {
                console.error('Error retrieving session:', error);
                // Fallback to basic confirmation
                populateOrderDetails({
                    orderId: 'EG-' + Date.now(),
                    amount: 79.00,
                    product: 'Personalized Song',
                    email: 'customer@example.com',
                    estimatedDelivery: getEstimatedDelivery()
                });
            }
        }

        function populateOrderDetails(confirmationData) {
            document.getElementById('order-id').textContent = confirmationData.orderId;
            document.getElementById('order-reference').textContent = confirmationData.orderId;
            
            // Handle Elyson free orders differently
            if (confirmationData.isElysonFree) {
                document.getElementById('product-name').textContent = confirmationData.productName || 'Elyson Special - FREE';
                document.getElementById('amount-paid').textContent = 'FREE';
                document.getElementById('customer-email').textContent = 'Order submitted successfully';
                document.getElementById('delivery-date').textContent = getEstimatedDelivery();
                
                // Update the page title and messaging for free orders
                const titleElement = document.querySelector('h1');
                if (titleElement) {
                    titleElement.innerHTML = 'üéâ Your Free Elyson Order is Confirmed!';
                }
            } else {
                document.getElementById('product-name').textContent = confirmationData.product;
                document.getElementById('amount-paid').textContent = `$${confirmationData.amount.toFixed(2)}`;
                document.getElementById('customer-email').textContent = confirmationData.email;
                document.getElementById('delivery-date').textContent = confirmationData.estimatedDelivery;
            }
        }

        function getEstimatedDelivery() {
            const deliveryDate = new Date();
            deliveryDate.setDate(deliveryDate.getDate() + 5); // 5 business days
            return deliveryDate.toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        function showSuccessMessage(message) {
            // Create success message element
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27AE60;
                color: white;
                padding: 16px 24px;
                border-radius: 12px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                font-weight: 500;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            messageDiv.textContent = message;
            
            document.body.appendChild(messageDiv);
            
            // Animate in
            setTimeout(() => {
                messageDiv.style.transform = 'translateX(0)';
            }, 100);
            
            // Remove after 5 seconds
            setTimeout(() => {
                messageDiv.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (messageDiv.parentNode) {
                        messageDiv.parentNode.removeChild(messageDiv);
                    }
                }, 300);
            }, 5000);
        }

        // Prevent back button after successful order
        history.pushState(null, null, location.href);
        window.onpopstate = function () {
            history.go(1);
        };
    </script>
</body>
</html>