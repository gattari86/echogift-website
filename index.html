<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personalized Song Gift - Custom AI Songs for Any Occasion | EchoGift</title>
    <meta name="description" content="Create the perfect personalized song gift for boyfriend, girlfriend, mom, dad or anyone special. Custom AI-generated songs from $49.99. The unique gift for someone who has everything!">
    <meta name="keywords" content="personalized song, custom song, personalized song gift, custom song gift, personalized song for boyfriend, personalized song for girlfriend, unique Christmas gift, gift for someone who has everything, AI song generator, custom artwork, anniversary song, birthday song">
    <meta name="author" content="EchoGift">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="theme-color" content="#A25524">
    <meta name="google-site-verification" content="dcb1WtIscqkG9GJ7B45Uh7Kqfh5xskpn1O78neMfoc8">
    <link rel="canonical" href="https://echogifts.shop/">
    
    <!-- Geo-targeting and Local SEO -->
    <meta name="geo.region" content="US">
    <meta name="geo.placename" content="United States">
    <meta name="geo.position" content="40.7128;-74.0060">
    <meta name="ICBM" content="40.7128, -74.0060">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://echogifts.shop/">
    <meta property="og:title" content="Personalized Song Gift - Custom AI Songs for Any Occasion | EchoGift">
    <meta property="og:description" content="Create the perfect personalized song gift for boyfriend, girlfriend, mom, dad or anyone special. Custom AI-generated songs from $49.99. The unique gift for someone who has everything!">
    <meta property="og:image" content="https://echogifts.shop/audio/Two%20decades.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="EchoGift - Custom personalized song artwork example">
    <meta property="og:site_name" content="EchoGift">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://echogifts.shop/">
    <meta property="twitter:title" content="Personalized Song Gift - Custom AI Songs for Any Occasion | EchoGift">
    <meta property="twitter:description" content="Create the perfect personalized song gift for boyfriend, girlfriend, mom, dad or anyone special. Custom AI-generated songs from $49.99. The unique gift for someone who has everything!">
    <meta property="twitter:image" content="https://echogifts.shop/audio/Two%20decades.png">
    <meta property="twitter:image:alt" content="EchoGift - Custom personalized song artwork example">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="EchoGift">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Analytics & Conversion Tracking -->
    <!-- Google Analytics 4 with Enhanced Ecommerce -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QXKL1J8X23"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      // Configure GA4 with enhanced ecommerce
      gtag('config', 'G-QXKL1J8X23', {
        enhanced_ecommerce: true,
        conversion_linker: true,
        allow_enhanced_conversions: true
      });
      
      // Track page views
      gtag('event', 'page_view', {
        page_title: document.title,
        page_location: window.location.href,
        page_path: window.location.pathname
      });
    </script>
    
    <!-- Enhanced Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "EchoGift - Personalized AI Song Gifts",
        "description": "Create custom AI-generated songs and albums as unique gifts for birthdays, anniversaries, and special occasions",
        "url": "https://echogifts.shop",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://echogifts.shop/#order?q={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "EchoGift",
        "url": "https://echogifts.shop",
        "logo": "https://echogifts.shop/favicon.ico",
        "description": "EchoGift creates personalized AI-generated songs and albums as unique gifts for any occasion",
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "hello@echogifts.shop",
            "contactType": "customer support"
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": "Personalized Song Gift",
        "description": "Custom AI-generated song with your personal story and custom artwork. Perfect for birthdays, anniversaries, and special moments.",
        "brand": {
            "@type": "Brand",
            "name": "EchoGift"
        },
        "offers": {
            "@type": "Offer",
            "price": "49.99",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock",
            "seller": {
                "@type": "Organization",
                "name": "EchoGift"
            }
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "127",
            "bestRating": "5",
            "worstRating": "1"
        },
        "review": [
            {
                "@type": "Review",
                "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": "5",
                    "bestRating": "5"
                },
                "author": {
                    "@type": "Person",
                    "name": "Sarah M."
                },
                "reviewBody": "I gave my husband a song about our 20-year journey together for our anniversary. He cried happy tears – it captured our story perfectly."
            },
            {
                "@type": "Review",
                "reviewRating": {
                    "@type": "Rating",
                    "ratingValue": "5",
                    "bestRating": "5"
                },
                "author": {
                    "@type": "Person",
                    "name": "Michael R."
                },
                "reviewBody": "My daughter's graduation song included all her achievements and dreams. She plays it every morning before work. Best gift I've ever given."
            }
        ]
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": "Custom Song Album",
        "description": "5 personalized songs telling your complete story with custom album-inspired artwork",
        "brand": {
            "@type": "Brand",
            "name": "EchoGift"  
        },
        "offers": {
            "@type": "Offer",
            "price": "199.99",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock",
            "seller": {
                "@type": "Organization",
                "name": "EchoGift"
            }
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "reviewCount": "89"
        }
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "How do I order a custom song?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Simply fill out our order form with your story details, choose your genre, and we'll create your personalized song gift within 2 business days."
                }
            },
            {
                "@type": "Question",
                "name": "How will I get my song?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Once your song is complete, you'll receive an email with a secure download link. You'll be able to download both WAV and MP3 versions of your song. If your package includes artwork, a PNG file will be included too."
                }
            },
            {
                "@type": "Question",
                "name": "What makes the perfect personalized song for my boyfriend?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Share your relationship milestones, inside jokes, and special memories. Our AI creates custom songs that capture your unique love story - making it the perfect romantic gift."
                }
            }
        ]
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://echogifts.shop/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "Order",
                "item": "https://echogifts.shop/#order"
            }
        ]
    }
    </script>
    
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": "EchoGift - Custom AI Song Creation",
        "description": "Personalized AI-generated songs and albums for gifts",
        "url": "https://echogifts.shop",
        "telephone": "",
        "email": "hello@echogifts.shop",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "US"
        },
        "priceRange": "$49.99-$199.99",
        "openingHours": "Mo-Su 00:00-24:00",
        "sameAs": []
    }
    </script>

    <!-- Echo Chatbot Styles -->
    <style>
        /* Echo Chatbot Specific Variables */
        :root {
            --primary-brown: #8B4513;
            --secondary-brown: #D2691E;
            --light-cream: #F5F5DC;
            --accent-brown: #CD853F;
            --success-green: #10B981;
            --error-red: #EF4444;
        }

        /* Chatbot Instructions */
        .chatbot-instructions {
            background: linear-gradient(135deg, var(--light-cream) 0%, #F8F6F1 100%);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 2px solid var(--accent-brown);
        }

        .chatbot-instructions h3 {
            color: var(--primary-brown);
            margin-bottom: 20px;
            font-size: 1.3rem;
            text-align: center;
        }

        .instruction-steps {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .step {
            display: flex;
            align-items: center;
            gap: 12px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.1);
            flex: 1;
            min-width: 200px;
            max-width: 300px;
        }

        .step-number {
            background: var(--primary-brown);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            flex-shrink: 0;
        }

        .step p {
            margin: 0;
            color: var(--primary-brown);
            font-size: 14px;
            line-height: 1.4;
        }

        /* Echo Chat Container */
        .echo-chat-container {
            background: linear-gradient(135deg, #FEFCF8 0%, #F9F6F1 100%);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(139, 69, 19, 0.15);
            border: 2px solid var(--accent-brown);
            position: relative;
            overflow: hidden;
        }

        .echo-chat-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-brown), var(--secondary-brown), var(--accent-brown));
        }

        .echo-header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-brown);
        }

        .echo-header h3 {
            color: var(--primary-brown);
            margin: 0 0 8px 0;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .echo-header p {
            color: var(--secondary-brown);
            margin: 0;
            font-style: italic;
            font-size: 1rem;
        }

        .chat-messages {
            max-height: 500px;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 8px;
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: var(--light-cream);
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--accent-brown);
            border-radius: 3px;
        }

        .message {
            margin-bottom: 16px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
            animation: fadeInUp 0.4s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-brown);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: var(--secondary-brown);
        }

        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            background: white;
            box-shadow: 0 2px 8px rgba(139, 69, 19, 0.1);
            color: var(--primary-brown);
            line-height: 1.5;
        }

        .message.user .message-content {
            background: var(--primary-brown);
            color: white;
        }

        .lyrics-display {
            background: #FFFEF9;
            border: 2px solid var(--accent-brown);
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Georgia', serif;
            white-space: pre-line;
            line-height: 1.8;
            color: var(--primary-brown);
            box-shadow: 0 4px 16px rgba(139, 69, 19, 0.1);
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .chat-button {
            background: var(--primary-brown);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            border: 2px solid var(--primary-brown);
        }

        .chat-button:hover {
            background: var(--secondary-brown);
            border-color: var(--secondary-brown);
            transform: translateY(-2px);
        }

        .chat-button.secondary {
            background: transparent;
            color: var(--primary-brown);
            border-color: var(--primary-brown);
        }

        .chat-button.secondary:hover {
            background: var(--primary-brown);
            color: white;
        }

        .echo-input-area {
            background: white;
            border-radius: 25px;
            padding: 8px;
            box-shadow: 0 4px 16px rgba(139, 69, 19, 0.15);
            border: 2px solid var(--accent-brown);
        }

        .echo-input-group {
            display: flex;
            align-items: flex-end;
            gap: 10px;
        }

        .echo-input-wrapper {
            flex: 1;
        }

        #userInput {
            width: 100%;
            min-height: 50px;
            max-height: 120px;
            border: none;
            padding: 15px 20px;
            border-radius: 20px;
            resize: none;
            font-family: inherit;
            font-size: 16px;
            color: var(--primary-brown);
            background: transparent;
            outline: none;
        }

        #userInput::placeholder {
            color: var(--accent-brown);
            opacity: 0.7;
        }

        #sendButton {
            background: var(--primary-brown);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        #sendButton:hover {
            background: var(--secondary-brown);
            transform: scale(1.05);
        }

        #sendButton:disabled {
            background: var(--accent-brown);
            cursor: not-allowed;
            transform: none;
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--accent-brown);
            font-style: italic;
            margin: 10px 0;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--accent-brown);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { opacity: 0.3; transform: scale(0.8); }
            30% { opacity: 1; transform: scale(1); }
        }

        /* Loading States */
        .loading {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .instruction-steps {
                flex-direction: column;
                align-items: center;
            }

            .step {
                max-width: 100%;
            }

            .echo-chat-container {
                padding: 20px 15px;
            }

            .message-content {
                max-width: 85%;
            }

            .button-group {
                flex-direction: column;
            }

            .chat-button {
                width: 100%;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Header --> 
    <header class="main-header">
        <div class="container">
            <nav class="main-nav">
                <a href="index.html" class="logo">EchoGift</a>
                <div class="nav-menu">
                    <a href="about.html" class="nav-link">About</a>
                    <a href="gallery.html" class="nav-link">
                        <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg>
                        Gallery
                    </a>
                    <a href="single-song.html" class="nav-link">Single Song ($49.99)</a>
                    <a href="album-gift.html" class="nav-link">Album Gift ($199.99)</a>
                    <a href="blog.html" class="nav-link">
                        <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M227.31,73.37,182.63,28.68a16,16,0,0,0-22.63,0L36.69,152A15.86,15.86,0,0,0,32,163.31V208a16,16,0,0,0,16,16H92.69A15.86,15.86,0,0,0,104,219.31L227.31,96a16,16,0,0,0,0-22.63ZM92.69,208H48V163.31l88-88L180.69,120ZM192,108.68,147.31,64l24-24L216,84.68Z"/></svg>
                        Blog
                    </a>
                    <a href="#order" class="nav-cta">Order Now</a>
                </div>
                <div class="mobile-menu-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Turn Your Story Into a Song</h1>
                <p class="hero-subtitle">A deeply personal AI-crafted gift, born from your memories. Create intimate musical moments that capture love, celebration, and connection in every note.</p>
                <button class="cta-button" onclick="scrollToOrder()">Begin Your Musical Story</button>
            </div>
            <div class="hero-visual">
                <div class="music-wave">
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                    <div class="wave-bar"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section class="pricing">
        <div class="container">
            <div class="pricing-cards">
                <div class="price-card">
                    <h3>Single Song</h3>
                    <div class="price">$49.99</div>
                    <p>Perfect for birthdays, anniversaries, or any special moment + custom artwork</p>
                    <a href="single-song.html" class="card-link">Learn More →</a>
                </div>
                <div class="price-card featured">
                    <h3>Album</h3>
                    <div class="price">$199.99</div>
                    <p>5 songs telling your complete story + custom artwork</p>
                    <div class="album-artwork-note">
                        <small><svg style="width: 14px; height: 14px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M200,76a44.05,44.05,0,0,0-44-44c-21.44,0-38.24,10.33-50.68,31.07C91,85,80,108.52,80,132c0,27.72,9.72,52.9,27.36,70.88A44,44,0,0,0,138.3,216c15.35,0,27.15-6.64,36-12.87,10.4-7.33,15.69-13.72,15.7-13.73a8,8,0,0,0-11-11.64s-3.8,4.58-12.28,10.58c-7.12,5-14.27,9.66-24.42,9.66a28,28,0,0,1-19.35-7.5C107.53,176.56,96,153.9,96,132c0-17.87,8.17-36.55,20.42-57.65C125.5,58.32,138.72,48,156,48a28,28,0,1,1,0,56H140a8,8,0,0,0,0,16h16A44,44,0,0,0,200,76ZM76,196a16,16,0,1,1-16-16A16,16,0,0,1,76,196Z"/></svg>Includes custom album-inspired artwork designed specifically for your story</small>
                    </div>
                    <span class="badge">Most Popular</span>
                    <a href="album-gift.html" class="card-link">Learn More →</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Audio Samples Section -->
    <section id="audio-samples" class="audio-samples">
        <div class="container">
            <h2>Hear the Magic - Real Customer Songs</h2>
            <p class="samples-subtitle">Listen to actual personalized songs we've created for our customers. Each tells a unique story.</p>
            
            <div class="samples-grid">
                <div class="sample-card">
                    <div class="sample-artwork">
                        <img src="audio/Two decades.png" alt="Custom artwork for Two Decades Strong - Anniversary song artwork featuring romantic elements" class="song-artwork">
                    </div>
                    <div class="sample-info">
                        <h3>"Two Decades Strong"</h3>
                        <p class="sample-story">Created for Sarah M.'s 20th anniversary gift to her husband. A beautiful journey through their marriage milestones.</p>
                        <p class="sample-details"><strong>Genre:</strong> Acoustic Folk • <strong>Occasion:</strong> Anniversary</p>
                    </div>
                    <div class="audio-player-container">
                        <audio controls preload="metadata" class="custom-audio-player">
                            <source src="audio/Two Decades Strong.wav" type="audio/wav">
                            Your browser does not support the audio element.
                        </audio>
                        <div class="play-info">
                            <span class="play-icon"><svg class="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="white"><path d="M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"/></svg></span>
                            <span class="duration">Listen to sample</span>
                        </div>
                    </div>
                </div>

                <div class="sample-card">
                    <div class="sample-artwork">
                        <img src="audio/The sky she reached.png" alt="Custom artwork for The Sky She Reached - Graduation song artwork featuring uplifting sky and achievement themes" class="song-artwork">
                    </div>
                    <div class="sample-info">
                        <h3>"The Sky She Reached"</h3>
                        <p class="sample-story">Michael R.'s graduation gift for his daughter, celebrating her achievements and dreams for the future.</p>
                        <p class="sample-details"><strong>Genre:</strong> Uplifting Pop • <strong>Occasion:</strong> Graduation</p>
                    </div>
                    <div class="audio-player-container">
                        <audio controls preload="metadata" class="custom-audio-player">
                            <source src="audio/The Sky She Reached.wav" type="audio/wav">
                            Your browser does not support the audio element.
                        </audio>
                        <div class="play-info">
                            <span class="play-icon"><svg class="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="white"><path d="M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"/></svg></span>
                            <span class="duration">Listen to sample</span>
                        </div>
                    </div>
                </div>

                <div class="sample-card">
                    <div class="sample-artwork">
                        <img src="audio/Chapters of You.png" alt="Custom artwork for Chapters of You - Memorial song artwork featuring emotional and remembrance themes" class="song-artwork">
                    </div>
                    <div class="sample-info">
                        <h3>"Chapters of You"</h3>
                        <p class="sample-story">Jennifer L.'s tribute album about her late father, helping her family heal through music and memories.</p>
                        <p class="sample-details"><strong>Genre:</strong> Emotional Ballad • <strong>Occasion:</strong> Memorial</p>
                    </div>
                    <div class="audio-player-container">
                        <audio controls preload="metadata" class="custom-audio-player">
                            <source src="audio/Chapters of You (Remix).wav" type="audio/wav">
                            Your browser does not support the audio element.
                        </audio>
                        <div class="play-info">
                            <span class="play-icon"><svg class="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="white"><path d="M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"/></svg></span>
                            <span class="duration">Listen to sample</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="samples-cta">
                <p class="samples-note"><svg style="width: 16px; height: 16px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg> Each song is completely unique and created from the customer's personal story</p>
                <div class="samples-buttons" style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <a href="gallery.html" class="cta-button secondary" style="min-width: 280px; flex: 0 1 auto;"><svg style="width: 16px; height: 16px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg> Hear More Examples</a>
                    <button class="cta-button" onclick="scrollToOrder()" style="min-width: 280px; flex: 0 1 auto;">Create Your Custom Song</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Order Form Section -->
    <section id="order" class="order-form">
        <div class="container">
            <h2>Begin Your Story</h2>
            
            <!-- Chatbot Instructions -->
            <div class="chatbot-instructions">
                <h3>How It Works</h3>
                <div class="instruction-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <p>Chat with Echo to share your story and preferences</p>
                    </div>
                    <div class="step">
                        <span class="step-number">2</span>
                        <p>Review and customize your personalized lyrics</p>
                    </div>
                    <div class="step">
                        <span class="step-number">3</span>
                        <p>Complete your order and secure payment</p>
                    </div>
                </div>
            </div>

            <!-- Echo Chatbot Interface -->
            <div class="echo-chat-container">
                <div class="echo-header">
                    <h3>
                        <img src="echobot.png" alt="Echo" style="width: 24px; height: 24px; border-radius: 50%; margin-right: 8px;">
                        Your Lyric Lovebot
                    </h3>
                    <p>Your words, our music, one unforgettable gift.</p>
                </div>
                
                <!-- Chat Messages -->
                <div class="chat-messages" id="chatMessages"></div>
                
                <!-- Input Area -->
                <div class="echo-input-area">
                    <div class="echo-input-group">
                        <div class="echo-input-wrapper">
                            <textarea id="userInput" placeholder="Type your answer here..."></textarea>
                        </div>
                        <button id="sendButton" type="button">
                            <i class="ph ph-paper-plane-right"></i>
                        </button>
                    </div>
                </div>
            </div>

        </div>
    </section>

    <!-- Vinyl Section -->
    <section class="vinyl-section">
        <div class="container">
            <div class="vinyl-content">
                <h2>Vinyl Records – Coming Soon</h2>
                <p>Turn your AI-generated songs into beautiful vinyl records. Be the first to know when this magical option becomes available.</p>
                <form action="https://formspree.io/f/xkgzqpyy" method="POST" class="vinyl-signup">
                    <input type="email" name="email" placeholder="Enter your email" class="vinyl-email" required>
                    <input type="hidden" name="_subject" value="New Vinyl Waitlist Signup - EchoGift">
                    <input type="hidden" name="_next" value="https://echogifts.shop/#vinyl-success">
                    <button type="submit" class="vinyl-button">Join the Vinyl Waitlist</button>
                </form>
            </div>
            <div class="vinyl-visual">
                <div class="vinyl-record">
                    <div class="vinyl-center"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials">
        <div class="container">
            <h2>What Our Customers Say</h2>
            <div class="testimonial-grid">
                <div class="testimonial">
                    <div class="quote">"I gave my husband a song about our 20-year journey together for our anniversary. He cried happy tears – it captured our story perfectly."</div>
                    <div class="author">— Sarah M.</div>
                    <a href="#audio-samples" class="testimonial-link" onclick="scrollToSamples('Two Decades Strong')"><svg style="width: 16px; height: 16px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg> Hear Sarah's Song</a>
                </div>
                <div class="testimonial">
                    <div class="quote">"My daughter's graduation song included all her achievements and dreams. She plays it every morning before work. Best gift I've ever given."</div>
                    <div class="author">— Michael R.</div>
                    <a href="#audio-samples" class="testimonial-link" onclick="scrollToSamples('The Sky She Reached')"><svg style="width: 16px; height: 16px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg> Hear Michael's Song</a>
                </div>
                <div class="testimonial">
                    <div class="quote">"The album about my late father helped our whole family heal. Each song told a different chapter of his life. Absolutely beautiful."</div>
                    <div class="author">— Jennifer L.</div>
                    <a href="#audio-samples" class="testimonial-link" onclick="scrollToSamples('Chapters of You')"><svg style="width: 16px; height: 16px; fill: var(--terracotta); margin-right: 6px; vertical-align: middle;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"/></svg> Hear Jennifer's Song</a>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section">
        <div class="container">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-grid">
                <div class="faq-item">
                    <h3>How do I order a custom song?</h3>
                    <p>Simply fill out our order form above with your story details, choose your genre, and we'll create your personalized song gift within 2 business days.</p>
                </div>
                <div class="faq-item">
                    <h3>How will I get my song?</h3>
                    <p>Once your song is complete, you'll receive an email with a secure download link. You'll be able to download both WAV and MP3 versions of your song. If your package includes artwork, a PNG file will be included too.</p>
                </div>
                <div class="faq-item">
                    <h3>What makes the perfect personalized song for my boyfriend?</h3>
                    <p>Share your relationship milestones, inside jokes, and special memories. Our AI creates custom songs that capture your unique love story - making it the perfect romantic gift.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I get a personalized song for mom or dad?</h3>
                    <p>Absolutely! Personalized songs for parents are incredibly meaningful gifts. Share family memories, their achievements, or what they mean to you for a touching tribute.</p>
                </div>
                <div class="faq-item">
                    <h3>Is this a good unique Christmas gift?</h3>
                    <p>Yes! A custom song is the ultimate unique Christmas gift for anyone on your list - especially for someone who has everything. It's personal, memorable, and one-of-a-kind.</p>
                </div>
                <div class="faq-item">
                    <h3>How does your AI song generator work?</h3>
                    <p>Our advanced AI analyzes your story and preferences to compose original lyrics and melodies. Each personalized song is unique and professionally produced.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I order a custom anniversary song?</h3>
                    <p>Perfect for anniversaries! Share your relationship timeline, special moments, and what your partner means to you. We'll create a romantic custom anniversary song they'll treasure forever.</p>
                </div>
                <div class="faq-item">
                    <h3>Do you create personalized birthday songs?</h3>
                    <p>Yes! Personalized birthday songs are incredibly popular. Include the person's interests, achievements, and what makes them special for a birthday gift they'll never forget.</p>
                </div>
                <div class="faq-item">
                    <h3>How is this different from Songfinch?</h3>
                    <p>Unlike Songfinch, we use cutting-edge AI technology to create your songs faster and more affordably while maintaining professional quality. Plus, we offer vinyl records coming soon!</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Gift Ideas Section -->
    <section class="gift-ideas">
        <div class="container">
            <h2>Perfect For Every Occasion</h2>
            <div class="occasion-grid">
                <div class="occasion-card">
                    <h3>Romantic Gifts</h3>
                    <p>Personalized songs for boyfriends, girlfriends, and spouses. Custom anniversary songs and wedding gifts that capture your love story.</p>
                </div>
                <div class="occasion-card">
                    <h3>Family Celebrations</h3>
                    <p>Personalized songs for mom, dad, grandparents, and siblings. Perfect for birthdays, graduations, and family milestones.</p>
                </div>
                <div class="occasion-card">
                    <h3>Holiday Gifts</h3>
                    <p>Unique Christmas gifts, Valentine's Day surprises, and Mother's/Father's Day presents. The gift for someone who has everything!</p>
                </div>
                <div class="occasion-card">
                    <h3>Music Lovers</h3>
                    <p>Custom songs for music enthusiasts, musicians, and anyone who appreciates personalized art. AI-generated songs with professional quality.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>EchoGift</h3>
                    <p>Your story, your song.</p>
                </div>
                <div class="footer-links">
                    <a href="terms-of-service.html">Terms of Service</a>
                    <a href="privacy-policy.html">Privacy Policy</a>
                    <a href="mailto:hello@echogifts.shop">Contact</a>
                </div>
                <div class="footer-social">
                    <a href="#" aria-label="Facebook"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.13,104.13,0,0,0,128,24Zm8,191.63V152h24a8,8,0,0,0,0-16H136V112a16,16,0,0,1,16-16h16a8,8,0,0,0,0-16H152a32,32,0,0,0-32,32v24H96a8,8,0,0,0,0,16h24v63.63a88,88,0,1,1,16,0Z"/></svg></a>
                    <a href="#" aria-label="Instagram"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M208,56H180.28L166.65,35.56A8,8,0,0,0,160,32H96a8,8,0,0,0-6.65,3.56L75.71,56H48A24,24,0,0,0,24,80V192a24,24,0,0,0,24,24H208a24,24,0,0,0,24-24V80A24,24,0,0,0,208,56Zm8,136a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8H80a8,8,0,0,0,6.66-3.56L100.28,48h55.43l13.63,20.44A8,8,0,0,0,176,72h32a8,8,0,0,1,8,8ZM128,88a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,88Zm0,72a28,28,0,1,1,28-28A28,28,0,0,1,128,160Z"/></svg></a>
                    <a href="#" aria-label="Twitter"><svg class="social-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256"><path d="M247.39,68.94A8,8,0,0,0,240,64H209.57A48.66,48.66,0,0,0,168.1,40a46.91,46.91,0,0,0-33.75,13.7A47.9,47.9,0,0,0,120,88v6.09C79.74,83.47,46.81,50.72,46.46,50.37a8,8,0,0,0-13.65,4.92c-4.31,47.79,9.57,79.77,22,98.18a110.93,110.93,0,0,0,21.88,24.2c-15.23,17.53-39.21,26.74-39.47,26.84a8,8,0,0,0-3.85,11.93c.75,1.12,3.75,5.05,11.08,8.72C53.51,229.7,65.48,232,80,232c70.67,0,129.72-54.42,135.75-124.44l29.91-29.9A8,8,0,0,0,247.39,68.94Zm-45.54,40.2a8,8,0,0,0-2.32,5.14C196,180.5,144.05,216,80,216c-8.06,0-15-1.12-20.62-2.54a111.14,111.14,0,0,0,35.81-18.54,8,8,0,0,0-.30-14.02c-.38-.2-38.47-20.42-48.65-70.84,17.29,8.17,45.66,16.69,88.19,5.47a8,8,0,0,0,6.66-9.8A31.81,31.81,0,0,1,136,88a32,32,0,0,1,32-32c16.16,0,32,14.78,32,32v32Z"/></svg></a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 EchoGift. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>

    <!-- Echo Chatbot JavaScript -->
    <script>
        // Enhanced Echo Chatbot with complete flow
        class EchoChatbot {
            constructor() {
                this.conversationState = {
                    step: 'start',
                    data: {
                        productType: '',
                        customerName: '',
                        recipientName: '',
                        occasion: '',
                        story: '',
                        genre: '',
                        tone: '',
                        language: '',
                        email: '',
                        finalLyrics: ''
                    }
                };
                this.init();
            }

            init() {
                this.chatMessages = document.getElementById('chatMessages');
                this.userInput = document.getElementById('userInput');
                this.sendButton = document.getElementById('sendButton');

                if (!this.chatMessages) {
                    return;
                }
                
                this.sendButton.addEventListener('click', () => this.sendMessage());
                this.userInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });

                // Add event delegation for chat buttons
                this.chatMessages.addEventListener('click', (e) => {
                    
                    // Check if target or parent is a chat button
                    let button = e.target;
                    if (!button.classList.contains('chat-button')) {
                        button = button.closest('.chat-button');
                    }
                    
                    if (button && button.classList.contains('chat-button')) {
                        
                        const action = button.getAttribute('data-action');
                        const functionName = button.getAttribute('data-function');
                        
                        if (action !== null && action !== '') {
                            const index = parseInt(action);
                            this.handleButtonClick(index);
                        } else if (functionName) {
                            if (this[functionName]) {
                                this[functionName]();
                            }
                        }
                    } else {
                    }
                });

                this.startConversation();
            }

            startConversation() {
                setTimeout(() => {
                    this.addBotMessage("Hello! I'm Echo, your personal lyric assistant. I'm here to help you create a beautiful, personalized song that captures your story. Let's begin!");
                    
                    setTimeout(() => {
                        this.addBotMessage("First, what type of gift would you like to create?", [
                            { text: "Single Song ($49.99)", action: () => this.setProductType('single') },
                            { text: "Album - 5 Songs ($199.99)", action: () => this.setProductType('album') }
                        ]);
                    }, 1500);
                }, 1000);
            }

            setProductType(type) {
                this.conversationState.data.productType = type;
                this.conversationState.step = 'customer_name';
                
                const message = type === 'single' ? 'Perfect! A single song is a beautiful, personal gift.' : 'Excellent choice! An album will tell a complete story across 5 unique songs.';
                this.addBotMessage(message);
                
                setTimeout(() => {
                    this.addBotMessage("What's your name? (This helps me personalize our conversation)");
                }, 1000);
            }

            sendMessage() {
                const message = this.userInput.value.trim();
                if (!message) return;

                this.addUserMessage(message);
                this.userInput.value = '';
                this.processUserMessage(message);
            }

            processUserMessage(message) {
                switch (this.conversationState.step) {
                    case 'customer_name':
                        this.conversationState.data.customerName = message;
                        this.conversationState.step = 'recipient_relationship';
                        this.addBotMessage(`Nice to meet you, ${message}! Now, who is this song for? (e.g., "my mom", "my boyfriend", "my daughter")`);
                        break;

                    case 'recipient_relationship':
                        this.conversationState.step = 'recipient_name';
                        this.addBotMessage(`Wonderful! What is their actual name? This will help me create more personal lyrics.`);
                        break;

                    case 'recipient_name':
                        this.conversationState.data.recipientName = message;
                        this.conversationState.step = 'occasion';
                        this.addBotMessage(`Great! What's the occasion for this gift? (e.g., birthday, anniversary, graduation, just because)`);
                        break;

                    case 'occasion':
                        this.conversationState.data.occasion = message;
                        this.conversationState.step = 'language';
                        this.addBotMessage("Would you prefer the song to be in English or Spanish?", [
                            { text: "English", action: () => this.setLanguage('english') },
                            { text: "Spanish", action: () => this.setLanguage('spanish') }
                        ]);
                        break;

                    case 'story':
                        this.conversationState.data.story = message;
                        this.conversationState.step = 'genre';
                        this.addBotMessage("Perfect! Now let's choose the musical style. What genre would best fit this song?", [
                            { text: "Pop", action: () => this.setGenre('pop') },
                            { text: "Acoustic", action: () => this.setGenre('acoustic') },
                            { text: "Country", action: () => this.setGenre('country') },
                            { text: "Rock", action: () => this.setGenre('rock') },
                            { text: "Folk", action: () => this.setGenre('folk') },
                            { text: "R&B", action: () => this.setGenre('r&b') }
                        ]);
                        break;

                    case 'email':
                        this.conversationState.data.email = message;
                        this.generateLyrics();
                        break;

                    case 'add_memories':
                        this.processRevision(`Please add these specific memories and details to the lyrics: ${message}`);
                        break;

                    case 'custom_revision':
                        this.processRevision(message);
                        break;

                    default:
                        this.addBotMessage("I'm not sure what you mean. Could you please try again?");
                }
            }

            setLanguage(language) {
                this.conversationState.data.language = language;
                this.conversationState.step = 'story';
                this.addBotMessage(`Perfect! The song will be in ${language === 'english' ? 'English' : 'Spanish'}. Now, tell me the story! Share the memories, feelings, and special moments you want captured in this song. The more details you give me, the more personal and meaningful the lyrics will be.`);
            }

            setGenre(genre) {
                this.conversationState.data.genre = genre;
                this.conversationState.step = 'tone';
                const toneButtons = [
                    { text: "Upbeat & Joyful", action: () => this.setTone('upbeat') },
                    { text: "Romantic", action: () => this.setTone('romantic') },
                    { text: "Nostalgic", action: () => this.setTone('nostalgic') },
                    { text: "Emotional", action: () => this.setTone('emotional') },
                    { text: "Celebratory", action: () => this.setTone('celebratory') }
                ];
                this.addBotMessage(`${genre} is a great choice! What tone should the song have?`, toneButtons);
            }

            setTone(tone) {
                this.conversationState.data.tone = tone;
                this.conversationState.step = 'email';
                this.addBotMessage("Almost ready! What's your email address? This is where I'll send your completed song files (WAV + MP3) and custom artwork.");
            }

            async generateLyrics() {
                this.showTyping("🎵 Analyzing your story and creating personalized lyrics with Claude AI...");
                
                try {
                    const response = await fetch('http://127.0.0.1:5001/generate-lyrics', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            recipient: this.conversationState.data.recipientName,
                            story: this.conversationState.data.story,
                            occasion: this.conversationState.data.occasion,
                            genre: this.conversationState.data.genre,
                            mood: this.conversationState.data.tone,
                            language: this.conversationState.data.language,
                            customer_email: this.conversationState.data.email || 'from_chatbot'
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        this.hideTyping();
                        this.displayLyrics(data.lyrics);
                    } else {
                        throw new Error('Failed to generate lyrics');
                    }
                } catch (error) {
                    this.hideTyping();
                    // Use high-quality fallback
                    this.generateFallbackLyrics();
                }
            }

            generateFallbackLyrics() {
                // Generate personalized fallback lyrics based on the story data
                const { recipientName, occasion, story, tone, genre, language } = this.conversationState.data;
                
                let lyrics = '';
                if (language === 'spanish') {
                    lyrics = `[Verso 1]
${recipientName}, mi amor, esta canción es para ti
En este ${occasion} tan especial
Quiero contarte lo que siento aquí
Todo lo que me haces vibrar

[Coro]
Eres la música en mi corazón
La melodía que me hace soñar
${recipientName}, eres mi canción
La historia que quiero contar

[Verso 2]
Cada recuerdo que hemos compartido
Cada momento a tu lado
Es un tesoro que he atesorado
Un regalo que la vida me ha dado

[Coro]
Eres la música en mi corazón
La melodía que me hace soñar
${recipientName}, eres mi canción
La historia que quiero contar

[Puente]
Y en cada nota de esta canción
Vive nuestro amor sin fin
${recipientName}, tú eres mi razón
Mi comienzo y mi final feliz

[Coro Final]
Eres la música en mi corazón
La melodía que me hace soñar
${recipientName}, eres mi canción
Por siempre te voy a amar`;
                } else {
                    lyrics = `[Verse 1]
${recipientName}, this song's written just for you
On this special ${occasion} day
All the memories that we've been through
Are the words I want to say

[Chorus]
You're the music in my heart
The melody that makes me whole
${recipientName}, you're my work of art
The story of my very soul

[Verse 2]
Every moment that we've shared together
Every smile and every tear
Is a treasure I'll keep forever
That's why you're so precious and dear

[Chorus]
You're the music in my heart
The melody that makes me whole
${recipientName}, you're my work of art
The story of my very soul

[Bridge]
And in every note of this song
Lives the love that's true and real
${recipientName}, where you belong
Is right here, that's how I feel

[Final Chorus]
You're the music in my heart
The melody that makes me whole
${recipientName}, you're my work of art
Forever you'll be in my soul`;
                }

                this.displayLyrics(lyrics);
            }

            displayLyrics(lyrics) {
                this.conversationState.data.finalLyrics = lyrics;
                this.conversationState.step = 'review_lyrics';

                this.addBotMessage("Here are your personalized lyrics! I've crafted them specifically for your story:");
                
                const lyricsContainer = document.createElement('div');
                lyricsContainer.className = 'message bot';
                lyricsContainer.innerHTML = `
                    <div class="message-avatar">E</div>
                    <div class="message-content">
                        <div class="lyrics-display">${lyrics}</div>
                        <div class="button-group">
                            <button class="chat-button secondary" data-function="requestChanges">Make Changes</button>
                            <button class="chat-button" data-function="approveLyrics">Love It! Order Now</button>
                        </div>
                    </div>
                `;
                
                this.chatMessages.appendChild(lyricsContainer);
                this.scrollToBottom();
            }

            requestChanges() {
                this.conversationState.step = 'revision_request';
                this.addBotMessage("I'd be happy to make changes! Please tell me specifically what you'd like me to adjust in the lyrics. For example:", [
                    { text: "Make it more romantic", action: () => this.processRevision("Make the lyrics more romantic and intimate") },
                    { text: "Add specific memories", action: () => this.askForSpecificMemories() },
                    { text: "Change the tone", action: () => this.changeTone() },
                    { text: "Custom request", action: () => this.customRevisionRequest() }
                ]);
            }

            askForSpecificMemories() {
                this.conversationState.step = 'add_memories';
                this.addBotMessage("What specific memories or details would you like me to include in the lyrics? Please describe them and I'll incorporate them into the song.");
            }

            changeTone() {
                this.conversationState.step = 'change_tone';
                this.addBotMessage("What tone would you prefer instead?", [
                    { text: "More upbeat", action: () => this.processRevision("Make the lyrics more upbeat and joyful") },
                    { text: "More emotional", action: () => this.processRevision("Make the lyrics more emotional and heartfelt") },
                    { text: "More celebratory", action: () => this.processRevision("Make the lyrics more celebratory and festive") },
                    { text: "More nostalgic", action: () => this.processRevision("Make the lyrics more nostalgic and reflective") }
                ]);
            }

            customRevisionRequest() {
                this.conversationState.step = 'custom_revision';
                this.addBotMessage("Please type exactly what changes you'd like me to make to the lyrics:");
            }

            async processRevision(revisionRequest) {
                this.addBotMessage("Perfect! Let me revise the lyrics based on your feedback...");
                this.showTyping("🎭 Working with Claude AI to revise your lyrics...");

                try {
                    const response = await fetch('http://127.0.0.1:5001/generate-lyrics', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            recipient: this.conversationState.data.recipientName,
                            story: this.conversationState.data.story,
                            occasion: this.conversationState.data.occasion,
                            genre: this.conversationState.data.genre,
                            mood: this.conversationState.data.tone,
                            language: this.conversationState.data.language,
                            customer_email: this.conversationState.data.email || 'from_chatbot',
                            revisionRequest: revisionRequest,
                            originalLyrics: this.conversationState.data.finalLyrics
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        this.hideTyping();
                        this.displayLyrics(data.lyrics);
                    } else {
                        throw new Error('Failed to revise lyrics');
                    }
                } catch (error) {
                    this.hideTyping();
                    this.addBotMessage("I apologize, but I'm having trouble connecting to my revision system. Let me create new lyrics based on your feedback instead.");
                    this.generateRevisedFallback(revisionRequest);
                }
            }

            generateRevisedFallback(revisionRequest) {
                // Simple revision based on request
                let revisedLyrics = this.conversationState.data.finalLyrics;
                
                if (revisionRequest.includes("romantic")) {
                    revisedLyrics = revisedLyrics.replace(/love/g, "deep love").replace(/heart/g, "soul");
                } else if (revisionRequest.includes("upbeat")) {
                    revisedLyrics = revisedLyrics.replace(/melody/g, "joyful melody").replace(/song/g, "celebration song");
                }
                
                this.displayLyrics(revisedLyrics);
            }

            approveLyrics() {
                this.conversationState.step = 'final_order';
                this.addBotMessage("Wonderful! Your lyrics are approved. Let me prepare your order...");
                
                setTimeout(() => {
                    this.showPaymentButton();
                }, 1500);
            }

            showPaymentButton() {
                const price = this.conversationState.data.productType === 'album' ? '$199.99' : '$49.99';
                const productName = this.conversationState.data.productType === 'album' ? 'Album' : 'Song';
                
                this.addBotMessage(`Perfect! Your personalized ${productName.toLowerCase()} is ready. Click below to complete your order with secure payment through Stripe.`, [
                    { text: `🎵 Complete Order - ${price}`, action: () => this.processPayment() }
                ]);
            }

            async processPayment() {
                this.addBotMessage("Processing your order and redirecting to secure payment...");
                
                try {
                    // Prepare order data using the same format as existing checkout.js
                    const orderData = {
                        productType: this.conversationState.data.productType,
                        customerName: this.conversationState.data.customerName,
                        recipientName: this.conversationState.data.recipientName,
                        occasion: this.conversationState.data.occasion,
                        storyThemes: this.conversationState.data.story,
                        genre: this.conversationState.data.genre,
                        tone: this.conversationState.data.tone,
                        languagePreference: this.conversationState.data.language,
                        email: this.conversationState.data.email,
                        finalLyrics: this.conversationState.data.finalLyrics,
                        delivery: 'digital'
                    };

                    // Send order details to Formspree (matching existing sendOrderDetailsEmail function)
                    try {
                        await this.sendOrderToFormspree(orderData);
                    } catch (emailError) {
                        console.log('Email sending failed, proceeding with payment:', emailError);
                        // Continue with payment even if email fails
                    }
                    
                    // Redirect to Stripe using existing payment links
                    this.redirectToStripePayment(orderData);
                    
                } catch (error) {
                    console.error('Payment processing error:', error);
                    this.addBotMessage("There was an issue processing your order. Please try again or contact support at hello@echogifts.shop");
                }
            }

            async sendOrderToFormspree(orderData) {
                const emailData = {
                    _subject: `🎵 NEW SONG ORDER - ${orderData.recipientName} (${orderData.occasion})`,
                    _template: 'box',
                    
                    // Order Summary
                    'Order Type': orderData.productType === 'single' ? 'Personalized Song ($49.99)' : 'Custom Album ($199.99)',
                    'Customer Name': orderData.customerName,
                    'Customer Email': orderData.email,
                    'Order Date': new Date().toLocaleDateString(),
                    'Order Source': 'EchoBot Chatbot',
                    
                    // Song Details
                    'Recipient Name': orderData.recipientName,
                    'Occasion': orderData.occasion,
                    'Genre': orderData.genre,
                    'Tone': orderData.tone,
                    'Language': orderData.languagePreference,
                    'Delivery Method': 'Digital Download',
                    
                    // Customer Story & Final Lyrics
                    'Story & Themes': orderData.storyThemes,
                    'Final Approved Lyrics': orderData.finalLyrics,
                    
                    // Technical details
                    'Order ID': 'EG-CHAT-' + Date.now(),
                    'Status': 'Payment Pending'
                };

                const response = await fetch('https://formspree.io/f/xqalgreg', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(emailData)
                });

                if (!response.ok) {
                    throw new Error('Failed to send order to Formspree');
                }
            }

            redirectToStripePayment(orderData) {
                // Use existing Stripe Payment Links from checkout.js
                const PAYMENT_LINKS = {
                    single: 'https://buy.stripe.com/14A8wPd1a7WHfjW69u97G04',  // $49.99 Single Song
                    album: 'https://buy.stripe.com/cNi5kDe5eccXefSdBW97G05'   // $199.99 Album
                };

                const paymentLink = PAYMENT_LINKS[orderData.productType];
                
                if (paymentLink) {
                    // Build URL with prefilled email and client reference ID
                    const url = new URL(paymentLink);
                    url.searchParams.set('prefilled_email', orderData.email);
                    url.searchParams.set('client_reference_id', 'EG-CHAT-' + Date.now());
                    
                    // Store order data for retrieval after payment
                    sessionStorage.setItem('pendingOrder', JSON.stringify(orderData));
                    
                    // Redirect to Stripe payment
                    window.location.href = url.toString();
                } else {
                    throw new Error('Payment link not configured for product type: ' + orderData.productType);
                }
            }


            addUserMessage(message) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message user';
                messageDiv.innerHTML = `
                    <div class="message-avatar">You</div>
                    <div class="message-content">${message}</div>
                `;
                this.chatMessages.appendChild(messageDiv);
                this.scrollToBottom();
            }

            addBotMessage(message, buttons = null) {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message bot';
                
                let buttonHtml = '';
                if (buttons) {
                    buttonHtml = '<div class="button-group">';
                    buttons.forEach((button, index) => {
                        buttonHtml += `<button class="chat-button" data-action="${index}">${button.text}</button>`;
                    });
                    buttonHtml += '</div>';
                    
                    // Store button actions
                    this.currentButtons = buttons;
                }

                messageDiv.innerHTML = `
                    <div class="message-avatar">
                        <img src="echobot.png" alt="Echo" style="width: 36px; height: 36px; border-radius: 50%;">
                    </div>
                    <div class="message-content">
                        ${message}
                        ${buttonHtml}
                    </div>
                `;
                
                this.chatMessages.appendChild(messageDiv);
                this.scrollToBottom();
                
                // Verify buttons were added to DOM
                if (buttons) {
                    setTimeout(() => {
                        const addedButtons = this.chatMessages.querySelectorAll('.chat-button');
                    }, 100);
                }
            }

            handleButtonClick(index) {
                if (this.currentButtons && this.currentButtons[index]) {
                    const action = this.currentButtons[index].action;
                    this.currentButtons = null; // Clear before executing to avoid race conditions
                    action(); // Execute the action
                } else {
                }
            }

            showTyping(customMessage = "Echo is typing...") {
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.id = 'typingIndicator';
                typingDiv.innerHTML = `
                    <div class="message-avatar">
                        <img src="echobot.png" alt="Echo" style="width: 36px; height: 36px; border-radius: 50%;">
                    </div>
                    <div>
                        ${customMessage}
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                `;
                this.chatMessages.appendChild(typingDiv);
                this.scrollToBottom();
            }

            hideTyping() {
                const typingIndicator = document.getElementById('typingIndicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }

            scrollToBottom() {
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }
        }

        // Initialize the chatbot when the page loads
        let echoBot;
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chatMessages');
            
            if (chatMessages) {
                echoBot = new EchoChatbot();
                window.echoBot = echoBot; // Make globally accessible
            } else {
            }
        });

        // Add icon support for send button
        document.addEventListener('DOMContentLoaded', function() {
            // Add Phosphor Icons CSS if not already present
            if (!document.querySelector('link[href*="phosphoricons"]')) {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = 'https://unpkg.com/phosphor-icons@1.4.0/src/css/icons.css';
                document.head.appendChild(link);
            }
            
            // Replace icon with simple arrow if Phosphor icons don't load
            setTimeout(() => {
                const sendButton = document.getElementById('sendButton');
                if (sendButton && !sendButton.querySelector('.ph')) {
                    sendButton.innerHTML = '→';
                    sendButton.style.fontSize = '18px';
                    sendButton.style.fontWeight = 'bold';
                }
            }, 1000);
        });
    </script>

</body>
</html><!-- Deployment trigger Sat Aug  9 11:43:59 CDT 2025 -->
